Checar logs e schema atual no Supabase.

Corrigir automaticamente:

Uso do schema public.

Sempre usar UUIDs corretos (product_id, compartment_id, user_id).

Criar funÃ§Ã£o de mapeamento 1A1 â†’ UUID.

Ajustar movements para aceitar os campos certos.

Garantir que profiles (ou users) seja usado como referÃªncia para user_id.

Rodar o teste completo novamente (5 produtos â†’ entrada de 100, saÃ­da de 30).

Gerar relatÃ³rio final consolidado com saldos.

Se encontrar erro, corrigir e rodar de novo atÃ© que tudo bata com o esperado (70 em cada produto).

ğŸš€ Prompt para colar no Replit (Agent3 ou Console)
VocÃª Ã© responsÃ¡vel por **corrigir e validar toda a integraÃ§Ã£o com o Supabase** do projeto StockFlow.  
Execute as seguintes etapas, na ordem:

1. **Verificar schema atual** das tabelas `products`, `movements`, `compartments`, `profiles`:
   - Confirme tipos de IDs (`UUID` ou `bigint`).
   - Confirme se as tabelas estÃ£o no schema `public`.
   - Liste colunas relevantes (`id`, `code`, `address`, `product_id`, `compartment_id`, `user_id`, `qty`, `type`, `created_at`).

2. **Corrigir inconsistÃªncias**:
   - Todos os IDs devem ser `UUID`.
   - `movements.product_id` deve referenciar `products.id`.
   - `movements.compartment_id` deve referenciar `compartments.id`.
   - `movements.user_id` deve referenciar `profiles.id` (ou criar um `default test user`).
   - Se houver referÃªncias a tabelas antigas (`produtos`, `movimentos`, `usuarios`), eliminar e ajustar para `products`, `movements`, `profiles`.

3. **Implementar conversores automÃ¡ticos**:
   - Se `compartment_id` vier como `"1A1"`, converter para o UUID correto da tabela `compartments`.
   - Se `type` vier como `"entrada"` ou `"saida"`, mapear para `"ENTRADA"` ou `"SAIDA"`.

4. **Rodar teste automatizado completo**:
   - Criar 5 produtos fictÃ­cios (`AUTO1` a `AUTO5`).
   - Para cada produto:
     - Entrada de 100 unidades.
     - SaÃ­da de 30 unidades.
   - Consultar saldos finais.

5. **Gerar relatÃ³rio consolidado**:
   - Mostrar Produto, Compartimento, Esperado (70), Real (saldo do Supabase), Status (âœ… ou âŒ).

6. **AutocorreÃ§Ã£o**:
   - Se algum saldo nÃ£o bater, ajuste o schema/cÃ³digo automaticamente e repita os testes atÃ© que todos estejam corretos.

âš ï¸ Use a `SUPABASE_SERVICE_ROLE_KEY` para contornar o RLS.  
âš ï¸ Garanta que todas as operaÃ§Ãµes sejam feitas no **schema public**.

ğŸ¯ Objetivo final: Todos os 5 produtos com saldo correto de **70 unidades** no Supabase, sem erros 